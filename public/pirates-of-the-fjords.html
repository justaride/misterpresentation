<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pirates of the Fjord Crown</title>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --cream: #F0F8F8;
      --charcoal: #0A1A1A;
      --foam: #F0F8F8;
      --deep: #0A1A1A;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--charcoal);
      color: var(--cream);
      overflow-x: hidden;
    }

    /* Custom Cursor */
    .cursor-ring {
      position: fixed;
      width: 40px;
      height: 40px;
      border: 2px solid var(--cream);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      mix-blend-mode: difference;
      display: none;
    }

    .cursor-dot {
      position: fixed;
      width: 8px;
      height: 8px;
      background: var(--cream);
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      mix-blend-mode: difference;
      display: none;
    }

    @media (pointer: fine) {
      .cursor-ring, .cursor-dot { display: block; }
    }

    /* Progress Bar */
    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--cream), var(--cream)cc);
      transform-origin: left;
      transform: scaleX(0);
      z-index: 1000;
    }

    /* Spotlight Layer */
    .spotlight-layer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 100;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .spotlight-layer.active {
      opacity: 1;
    }

    /* Hero Section */
    .hero {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px;
      background: var(--charcoal);
      position: relative;
      overflow: hidden;
    }

    .hero-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    .hero-line {
      animation-duration: 20s;
      animation-iteration-count: infinite;
      animation-timing-function: ease-in-out;
      animation-name: float;
    }

    .hero-line:nth-child(2) {
      animation-delay: -10s;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .hero-content {
      text-align: center;
      max-width: 900px;
      z-index: 2;
      position: relative;
    }

    .hero-title {
      font-family: 'Instrument Serif', serif;
      font-size: clamp(3rem, 8vw, 7rem);
      font-weight: 400;
      letter-spacing: -0.02em;
      line-height: 1.2;
      margin-bottom: 30px;
      color: var(--cream);
    }

    .hero-title .line { display: block; }
    .hero-title .word {
      display: inline-block;
      opacity: 0;
      transform: translateY(30px);
      margin: 0 0.1em;
    }

    .hero-subtitle {
      font-size: clamp(1rem, 2vw, 1.5rem);
      color: rgba(250, 249, 245, 0.8);
      font-weight: 300;
      line-height: 1.6;
      margin-bottom: 50px;
      opacity: 0;
    }

    .scroll-indicator {
      position: absolute;
      bottom: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      opacity: 0;
    }

    .scroll-indicator span {
      font-size: 0.75rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(250, 249, 245, 0.6);
    }

    .scroll-line {
      width: 1px;
      height: 60px;
      background: linear-gradient(to bottom, var(--cream), transparent);
    }

    @keyframes scroll-bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(10px); }
    }

    /* Chapter Sections */
    .chapter {
      min-height: 100vh;
      display: flex;
      align-items: center;
      padding: 80px 60px;
      position: relative;
      overflow: hidden;
    }

    .chapter.light { background: var(--foam); color: var(--deep); }
    .chapter.dark { background: var(--deep); color: var(--foam); }

    .chapter-number {
      position: absolute;
      top: 60px;
      left: 60px;
      font-size: 3rem;
      font-weight: 300;
      opacity: 0.15;
      font-family: 'Instrument Serif', serif;
    }

    .chapter-inner {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      align-items: center;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
    }

    .chapter.dark .chapter-inner.reverse {
      grid-template-columns: 1fr 1fr;
    }

    .chapter-content {
      /* Initial state handled by GSAP */
    }

    .chapter-label {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      opacity: 0.6;
      margin-bottom: 15px;
      font-weight: 500;
    }

    .chapter-title {
      font-family: 'Instrument Serif', serif;
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 400;
      letter-spacing: -0.02em;
      line-height: 1.3;
      margin-bottom: 25px;
    }

    .chapter-description {
      font-size: 1.1rem;
      line-height: 1.8;
      opacity: 0.85;
    }

    .chapter-description p { margin-bottom: 15px; }

    /* Cast + Endings (Story Completeness) */
    .cast-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 16px;
      margin-top: 26px;
    }

    .cast-card {
      border-radius: 18px;
      padding: 16px 16px 14px;
      border: 1px solid transparent;
    }

    .chapter.light .cast-card {
      background: rgba(10, 26, 26, 0.06);
      border-color: rgba(10, 26, 26, 0.12);
    }

    .chapter.dark .cast-card {
      background: rgba(240, 248, 248, 0.06);
      border-color: rgba(240, 248, 248, 0.12);
    }

    .cast-role {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      opacity: 0.65;
      font-weight: 500;
    }

    .cast-name {
      margin-top: 8px;
      font-size: 1.05rem;
      font-weight: 600;
      letter-spacing: -0.01em;
    }

    .cast-desc {
      margin-top: 10px;
      font-size: 0.98rem;
      line-height: 1.7;
      opacity: 0.85;
    }

    .ending-choices {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 24px;
    }

    .ending-button {
      appearance: none;
      border: 1px solid currentColor;
      background: transparent;
      color: inherit;
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-weight: 600;
      opacity: 0.8;
      cursor: pointer;
      transition: opacity 0.2s ease, transform 0.2s ease, background-color 0.2s ease;
    }

    .ending-button:hover {
      opacity: 1;
      transform: translateY(-1px);
    }

    .ending-button:focus-visible {
      outline: 2px solid currentColor;
      outline-offset: 3px;
    }

    .ending-button.active {
      background: currentColor;
      opacity: 1;
      transform: translateY(-1px);
    }

    .chapter.light .ending-button.active { color: var(--foam); }
    .chapter.dark .ending-button.active { color: var(--deep); }

    .ending-detail {
      margin-top: 18px;
      font-size: 1.05rem;
      line-height: 1.8;
      opacity: 0.9;
      max-width: 46ch;
    }

    /* Illustration */
    .illustration {
      position: relative;
      height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .illustration svg {
      width: 100%;
      height: 100%;
      max-width: 500px;
      max-height: 500px;
    }

    /* Transition Section */
    .transition-section {
      height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--charcoal);
    }

    .transition-line {
      width: 1px;
      height: 0;
      background: var(--cream);
      opacity: 0.2;
    }

    /* Quote Section */
    .quote-section {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 80px 60px;
      background: var(--deep);
      color: var(--foam);
    }

    .quote {
      max-width: 800px;
      font-family: 'Instrument Serif', serif;
      font-size: clamp(2rem, 4vw, 2.8rem);
      font-weight: 400;
      line-height: 1.6;
      text-align: center;
      position: relative;
    }

    .quote-mark {
      font-size: 4rem;
      opacity: 0.3;
      display: block;
      margin-bottom: 20px;
    }

    /* Finale */
    .finale {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 60px;
      background: var(--deep);
      color: var(--foam);
      text-align: center;
    }

    .finale-rings {
      position: relative;
      width: 300px;
      height: 300px;
      margin-bottom: 60px;
    }

    .ring {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border: 2px solid var(--foam);
      border-radius: 50%;
      opacity: 0.3;
    }

    .finale-title {
      font-family: 'Instrument Serif', serif;
      font-size: clamp(2.5rem, 6vw, 4rem);
      font-weight: 400;
      letter-spacing: -0.02em;
      line-height: 1.3;
      margin-bottom: 30px;
    }

    .finale-text {
      font-size: 1.1rem;
      line-height: 1.8;
      max-width: 600px;
      opacity: 0.8;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .chapter-inner { grid-template-columns: 1fr; }
      .chapter { padding: 60px 30px; }
      .hero { padding: 40px 30px; }
      .chapter-number { left: 30px; }
      .cast-grid { grid-template-columns: 1fr; }
      @media (pointer: coarse) {
        .cursor-ring, .cursor-dot { display: none; }
      }
    }

    @media (prefers-reduced-motion: reduce) {
      * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
    }
  </style>
</head>
<body>
  <!-- Cursor -->
  <div class="cursor-ring"></div>
  <div class="cursor-dot"></div>

  <!-- Progress Bar -->
  <div class="progress-bar"></div>

  <!-- Spotlight Layer -->
  <svg class="spotlight-layer">
    <defs>
      <radialGradient id="spotlight-grad">
        <stop offset="0%" stop-color="var(--foam)" stop-opacity="0.08"/>
        <stop offset="100%" stop-color="transparent"/>
      </radialGradient>
    </defs>
    <circle id="spotlight-circle" r="200" fill="url(#spotlight-grad)"/>
  </svg>

  <!-- Hero Section -->
  <section class="hero">
    <!-- Hero Background SVG -->
    <svg class="hero-background" viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMid slice">
      <path class="hero-line" fill="var(--foam)" opacity="0.03" d="M0,560 Q140,460 260,520 Q380,580 520,520 Q660,460 780,520 Q900,580 1000,500 L1000,1000 L0,1000 Z"/>
      <path class="hero-line" fill="var(--foam)" opacity="0.02" d="M0,430 Q120,350 230,400 Q340,450 470,410 Q600,370 730,420 Q860,470 1000,420 L1000,1000 L0,1000 Z"/>
    </svg>

    <div class="hero-content">
      <h1 class="hero-title">
        <span class="line">
          <span class="word">Pirates</span>
          <span class="word">of</span>
          <span class="word">the</span>
        </span>
        <span class="line">
          <span class="word">Fjord</span>
          <span class="word">Crown</span>
        </span>
      </h1>
      <p class="hero-subtitle">A Scandinavian pirate saga where rogue captains clash with Viking warbands in fjords, on longboats, and through frozen wildlands.</p>
    </div>
    <div class="scroll-indicator">
      <span>Scroll to explore</span>
      <div class="scroll-line"></div>
    </div>
  </section>

  <!-- Chapter 1 -->
  <section class="chapter light">
    <span class="chapter-number">01</span>
    <div class="chapter-inner">
      <div class="chapter-content">
        <p class="chapter-label">Chapter One</p>
        <h2 class="chapter-title">The Black Cat Sets Sail</h2>
        <div class="chapter-description">
          <p>In the icy harbors of Norland, Captain Soren of the Black Cat gathers exiles, smugglers, and drifters into one outlaw fleet.</p>
          <p>Their prize is not just silver. Hidden runestones in the fjords can bend the wind, and every jarl and guildmaster wants them first.</p>
          <p>You choose your first crew by mercy or leverage: free prisoners, bargain with smugglers, or blackmail rivals. The Black Cat's politics are forged before the sails are.</p>
        </div>
      </div>
      <div class="illustration">
        <svg viewBox="0 0 500 500" fill="none">
          <path class="organic-path fade-path" fill="var(--deep)" opacity="0.3"
            d="M40 380 Q70 250 150 190 Q230 130 300 170 Q240 220 220 280 Q200 350 120 390 Q80 400 40 380 Z"/>
          <path class="organic-path fade-path" fill="var(--deep)" opacity="0.3"
            d="M460 370 Q430 240 350 180 Q280 130 210 170 Q280 210 300 280 Q320 350 390 390 Q430 405 460 370 Z"/>
          <path class="organic-path fade-path draw-path" fill="var(--deep)" opacity="0.4"
            d="M70 340 Q150 320 230 340 Q310 360 410 330 Q350 380 260 395 Q170 410 90 380 Q60 365 70 340 Z"/>
          <path class="organic-path fade-path scale-path" fill="var(--deep)"
            d="M205 305 Q225 290 250 292 Q275 294 294 310 Q278 322 252 327 Q226 332 206 323 Q195 315 205 305 Z"/>
        </svg>
      </div>
    </div>
  </section>

  <!-- Transition -->
  <div class="transition-section">
    <div class="transition-line"></div>
  </div>

  <!-- Chapter 2 -->
  <section class="chapter dark">
    <span class="chapter-number">02</span>
    <div class="chapter-inner reverse">
      <div class="illustration">
        <svg viewBox="0 0 500 500" fill="none">
          <path class="organic-path fade-path" fill="var(--foam)" opacity="0.2"
            d="M60 300 Q140 250 240 245 Q340 240 430 280 Q360 335 250 350 Q140 365 70 330 Q45 315 60 300 Z"/>
          <path class="organic-path fade-path" fill="var(--foam)" opacity="0.15"
            d="M230 110 Q280 140 300 210 Q310 255 275 300 Q240 255 210 210 Q190 165 230 110 Z"/>
          <path class="organic-path fade-path draw-path" fill="var(--foam)" opacity="0.3"
            d="M40 360 Q120 335 190 355 Q260 375 330 352 Q400 329 470 350 Q420 395 330 410 Q240 425 150 410 Q70 395 40 360 Z"/>
          <path class="organic-path fade-path scale-path" fill="var(--foam)"
            d="M350 130 Q380 115 405 135 Q420 155 405 175 Q386 195 360 188 Q338 182 330 160 Q328 140 350 130 Z"/>
        </svg>
      </div>
      <div class="chapter-content">
        <p class="chapter-label">Chapter Two</p>
        <h2 class="chapter-title">Raid at Iron Fjord</h2>
        <div class="chapter-description">
          <p>Word of the Black Cat reaches the Viking jarls. At Iron Fjord, longships seal the channel and the sea turns into a maze of hooks, arrows, and fire.</p>
          <p>This is where the game reveals its edge: win by outmaneuvering, boarding in chaos, and stealing momentum before the war horn finishes its call.</p>
          <p>Between volleys, you gamble with rune-wind. Use it openly to terrify, or subtly to misdirect. Either way, the sea collects what you owe.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Transition -->
  <div class="transition-section">
    <div class="transition-line"></div>
  </div>

  <!-- Chapter 3 -->
  <section class="chapter light">
    <span class="chapter-number">03</span>
    <div class="chapter-inner">
      <div class="chapter-content">
        <p class="chapter-label">Chapter Three</p>
        <h2 class="chapter-title">Through Pine and Frost</h2>
        <div class="chapter-description">
          <p>After the clash, the crew is scattered into the wilderness. You hunt, salvage, and rebuild through frozen forests and hidden coves.</p>
          <p>The journey turns personal when Soren spares Astrid, a Viking navigator. Their uneasy alliance becomes a love story shaped by survival, not destiny.</p>
          <p>Keep her as a hostage and the crew obeys. Treat her as a partner and the map opens. Trust becomes your most expensive resource.</p>
        </div>
      </div>
      <div class="illustration">
        <svg viewBox="0 0 500 500" fill="none">
          <path class="organic-path fade-path" fill="var(--deep)" opacity="0.3"
            d="M50 390 Q90 300 170 250 Q250 200 320 240 Q270 280 250 340 Q230 390 150 420 Q90 425 50 390 Z"/>
          <path class="organic-path fade-path" fill="var(--deep)" opacity="0.3"
            d="M450 390 Q410 295 335 250 Q270 210 205 240 Q255 280 280 340 Q305 395 375 420 Q420 425 450 390 Z"/>
          <path class="organic-path fade-path draw-path" fill="var(--deep)" opacity="0.4"
            d="M120 360 Q180 330 240 300 Q300 270 365 285 Q320 335 260 370 Q200 405 140 390 Q110 382 120 360 Z"/>
          <path class="organic-path fade-path scale-path" fill="var(--deep)"
            d="M220 285 Q235 270 250 278 Q265 286 270 304 Q260 318 244 321 Q228 324 216 313 Q208 300 220 285 Z"/>
        </svg>
      </div>
    </div>
  </section>

  <!-- Transition -->
  <div class="transition-section">
    <div class="transition-line"></div>
  </div>

  <!-- Chapter 4 -->
  <section class="chapter dark">
    <span class="chapter-number">04</span>
    <div class="chapter-inner reverse">
      <div class="illustration">
        <svg viewBox="0 0 500 500" fill="none">
          <path class="organic-path fade-path" fill="var(--foam)" opacity="0.2"
            d="M45 320 Q110 260 190 250 Q270 240 345 270 Q420 300 465 355 Q390 380 300 390 Q210 400 125 385 Q70 372 45 320 Z"/>
          <path class="organic-path fade-path" fill="var(--foam)" opacity="0.15"
            d="M85 170 Q130 120 190 130 Q250 140 280 190 Q300 235 270 275 Q235 240 190 235 Q145 230 110 250 Q80 265 70 230 Q70 195 85 170 Z"/>
          <path class="organic-path fade-path draw-path" fill="var(--foam)" opacity="0.3"
            d="M250 200 Q280 170 315 185 Q345 200 348 235 Q350 270 322 292 Q292 314 258 304 Q224 294 210 262 Q198 232 220 210 Q235 196 250 200 Z"/>
          <path class="organic-path fade-path scale-path" fill="var(--foam)"
            d="M120 120 Q180 105 235 132 Q290 159 340 146 Q300 190 245 202 Q190 214 145 188 Q105 165 120 120 Z"/>
        </svg>
      </div>
      <div class="chapter-content">
        <p class="chapter-label">Chapter Four</p>
        <h2 class="chapter-title">War on the Three Fjords</h2>
        <div class="chapter-description">
          <p>The finale erupts across sea and stone. Pirates and Vikings collide in boats, on black beaches, and in ravines where the runestone altar waits.</p>
          <p>Your choices shape the ending: unite rival crews, betray the jarls, forge a new sea law with Astrid at your side, or break the runestones and vanish into the wild.</p>
          <p>The crown is not a hat, it's a rulebook. Claim the wind, shatter it, or bind it to a code, and the North will remember you accordingly.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Transition -->
  <div class="transition-section">
    <div class="transition-line"></div>
  </div>

  <!-- Chapter 5 -->
  <section class="chapter light" data-testid="pirates-chapter-05">
    <span class="chapter-number">05</span>
    <div class="chapter-inner">
      <div class="chapter-content">
        <p class="chapter-label">Chapter Five</p>
        <h2 class="chapter-title">The People of the Fjords</h2>
        <div class="chapter-description">
          <p>In the North, every fjord has a law, and every law has a loophole. Outlaws, jarls, and rune-keepers all sell a version of truth.</p>
          <p>Your campaign is carried by faces as much as ships. The allies you keep and the enemies you spare decide what "victory" even means.</p>
        </div>

        <div class="cast-grid" data-testid="pirates-cast-grid">
          <div class="cast-card" data-testid="pirates-cast-soren">
            <div class="cast-role">Captain</div>
            <div class="cast-name">Soren "Black Cat"</div>
            <p class="cast-desc">An outlaw with a diplomat's smile and a raider's timing. Builds a fleet by turning desperation into strategy.</p>
          </div>
          <div class="cast-card" data-testid="pirates-cast-astrid">
            <div class="cast-role">Navigator</div>
            <div class="cast-name">Astrid of the Hidden Coves</div>
            <p class="cast-desc">A Viking navigator who knows every narrow passage. Her trust is the difference between a route and a home.</p>
          </div>
          <div class="cast-card" data-testid="pirates-cast-eirik">
            <div class="cast-role">Antagonist</div>
            <div class="cast-name">Jarl Eirik Ironhook</div>
            <p class="cast-desc">Wages war like a blockade: slow, inevitable, suffocating. Wants the runestones to turn the sea into property.</p>
          </div>
          <div class="cast-card" data-testid="pirates-cast-ragna">
            <div class="cast-role">Rival</div>
            <div class="cast-name">Ragna Frostjaw</div>
            <p class="cast-desc">A pirate captain who believes fear is the only stable law. Offers alliance when it benefits her, not a moment sooner.</p>
          </div>
          <div class="cast-card" data-testid="pirates-cast-edda">
            <div class="cast-role">Leverage</div>
            <div class="cast-name">Edda Skald-Runner</div>
            <p class="cast-desc">Runs rumor like a supply line. Can turn your mercy into legend or your cruelty into a bounty.</p>
          </div>
          <div class="cast-card" data-testid="pirates-cast-hjalmar">
            <div class="cast-role">Rune-Keeper</div>
            <div class="cast-name">Hjalmar of the Stones</div>
            <p class="cast-desc">An exiled keeper of runestone lore. Teaches the cost rules of rune-wind, and what happens when you ignore them.</p>
          </div>
        </div>
      </div>

      <div class="illustration" aria-hidden="true">
        <svg viewBox="0 0 500 500" fill="none">
          <path class="organic-path fade-path" fill="var(--deep)" opacity="0.26"
            d="M80 360 Q130 250 210 200 Q290 150 350 190 Q300 235 285 290 Q270 350 205 385 Q140 420 90 395 Q60 380 80 360 Z"/>
          <path class="organic-path fade-path draw-path" fill="var(--deep)" opacity="0.34"
            d="M205 95 Q250 65 295 95 Q330 125 318 180 Q300 270 290 345 Q280 420 250 430 Q220 420 210 345 Q200 270 182 180 Q170 125 205 95 Z"/>
          <path class="organic-path fade-path scale-path" fill="var(--deep)" opacity="0.32"
            d="M215 210 Q230 195 250 200 Q270 205 282 222 Q270 238 250 243 Q230 248 216 238 Q205 228 215 210 Z"/>
        </svg>
      </div>
    </div>
  </section>

  <!-- Transition -->
  <div class="transition-section">
    <div class="transition-line"></div>
  </div>

  <!-- Chapter 6 -->
  <section class="chapter dark" data-testid="pirates-chapter-06">
    <span class="chapter-number">06</span>
    <div class="chapter-inner reverse">
      <div class="illustration" aria-hidden="true">
        <svg viewBox="0 0 500 500" fill="none">
          <path class="organic-path fade-path" fill="var(--foam)" opacity="0.18"
            d="M60 330 Q130 255 220 245 Q310 235 385 270 Q455 305 465 360 Q385 400 300 405 Q215 410 140 392 Q75 375 60 330 Z"/>
          <path class="organic-path fade-path draw-path" fill="var(--foam)" opacity="0.26"
            d="M240 110 Q285 120 315 160 Q345 200 332 245 Q320 285 285 308 Q250 330 214 308 Q178 286 168 245 Q158 205 186 165 Q212 128 240 110 Z"/>
          <path class="organic-path fade-path scale-path" fill="var(--foam)" opacity="0.26"
            d="M210 250 Q225 236 250 236 Q275 236 290 250 Q275 265 250 268 Q225 271 210 258 Q200 250 210 250 Z"/>
        </svg>
      </div>

      <div class="chapter-content">
        <p class="chapter-label">Chapter Six</p>
        <h2 class="chapter-title">Paths to the Crown</h2>
        <div class="chapter-description">
          <p>The ending is not a coin flip. It is the sum of what you paid for power: who you saved, who you burned, and how often you asked the wind to lie.</p>
          <p>Choose a path to preview the kind of North your story creates.</p>
        </div>

        <div class="ending-choices" data-testid="pirates-ending-choices">
          <button class="ending-button active" type="button" aria-pressed="true" data-ending="unite" data-testid="pirates-ending-choice-unite">Unite the Crews</button>
          <button class="ending-button" type="button" aria-pressed="false" data-ending="betray" data-testid="pirates-ending-choice-betray">Betray the Jarls</button>
          <button class="ending-button" type="button" aria-pressed="false" data-ending="law" data-testid="pirates-ending-choice-law">Forge the Sea Law</button>
          <button class="ending-button" type="button" aria-pressed="false" data-ending="break" data-testid="pirates-ending-choice-break">Break the Runes</button>
        </div>

        <div class="ending-detail" data-testid="pirates-ending-detail">
          A coalition of outlaws holds the fjords together by shared rules and shared spoils. The jarls lose not to conquest, but to unity.
        </div>
      </div>
    </div>
  </section>

  <!-- Transition -->
  <div class="transition-section">
    <div class="transition-line"></div>
  </div>

  <!-- Quote Section -->
  <section class="quote-section">
    <blockquote class="quote">
      <span class="quote-mark">"</span>
      In the fjords, legends are not born on calm water.
    </blockquote>
  </section>

  <!-- Finale -->
  <section class="finale">
    <div class="finale-rings">
      <div class="ring" style="width: 100px; height: 100px;"></div>
      <div class="ring" style="width: 180px; height: 180px;"></div>
      <div class="ring" style="width: 260px; height: 260px;"></div>
    </div>
    <h2 class="finale-title">Claim the Fjord Crown</h2>
    <p class="finale-text">
      Pirates of the Fjord Crown is a campaign of sea warfare, wilderness survival, and hard choices. Sail alone, fall in love, or rewrite the North with fire and tide.
    </p>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    // Custom Cursor
    const cursorRing = document.querySelector('.cursor-ring');
    const cursorDot = document.querySelector('.cursor-dot');
    let cursorX = 0, cursorY = 0;
    let dotX = 0, dotY = 0;

    document.addEventListener('mousemove', (e) => {
      const mouseX = e.clientX;
      const mouseY = e.clientY;

      cursorX += (mouseX - cursorX) * 0.15;
      cursorY += (mouseY - cursorY) * 0.15;

      dotX += (mouseX - dotX) * 0.4;
      dotY += (mouseY - dotY) * 0.4;

      cursorRing.style.left = cursorX - 20 + 'px';
      cursorRing.style.top = cursorY - 20 + 'px';

      cursorDot.style.left = dotX - 4 + 'px';
      cursorDot.style.top = dotY - 4 + 'px';
    });

    // Spotlight Layer - Follow cursor on dark sections
    const spotlightLayer = document.querySelector('.spotlight-layer');
    const spotlightCircle = document.getElementById('spotlight-circle');
    const darkSections = document.querySelectorAll('.hero, .chapter.dark, .quote-section, .finale');

    document.addEventListener('mousemove', (e) => {
      if (spotlightCircle) {
        spotlightCircle.setAttribute('cx', e.clientX);
        spotlightCircle.setAttribute('cy', e.clientY);
      }
    });

    // Toggle spotlight on dark sections
    let spotlightActiveCount = 0;
    darkSections.forEach((section) => {
      ScrollTrigger.create({
        trigger: section,
        start: 'top bottom',
        end: 'bottom top',
        onEnter: () => {
          spotlightActiveCount += 1;
          spotlightLayer?.classList.add('active');
        },
        onEnterBack: () => {
          spotlightActiveCount += 1;
          spotlightLayer?.classList.add('active');
        },
        onLeave: () => {
          spotlightActiveCount = Math.max(0, spotlightActiveCount - 1);
          if (spotlightActiveCount === 0) spotlightLayer?.classList.remove('active');
        },
        onLeaveBack: () => {
          spotlightActiveCount = Math.max(0, spotlightActiveCount - 1);
          if (spotlightActiveCount === 0) spotlightLayer?.classList.remove('active');
        }
      });
    });

    // Hero Animations
    const heroTl = gsap.timeline();
    heroTl.to('.hero-title .word', {
      y: 0,
      opacity: 1,
      duration: 1,
      stagger: 0.08,
      ease: 'power3.out'
    })
    .to('.hero-subtitle', {
      opacity: 1,
      duration: 1,
      ease: 'power2.out'
    }, 0.3)
    .to('.scroll-indicator', {
      opacity: 1,
      duration: 0.8,
      ease: 'power2.out'
    }, 0.6);

    // SVG Draw Animations Setup
    document.querySelectorAll('.draw-path').forEach(path => {
      const length = path.getTotalLength();
      path.style.strokeDasharray = length;
      path.style.strokeDashoffset = length;
    });

    // Draw animations on scroll
    gsap.to('.draw-path', {
      strokeDashoffset: 0,
      duration: 1.5,
      stagger: 0.15,
      ease: 'power2.inOut',
      scrollTrigger: {
        trigger: '.chapter',
        start: 'top 70%'
      }
    });

    // Chapter Content Fade-In (using set + to pattern)
    gsap.set('.chapter-content', { opacity: 0, y: 40 });
    gsap.utils.toArray('.chapter-content').forEach(content => {
      gsap.to(content, {
        opacity: 1,
        y: 0,
        duration: 1,
        scrollTrigger: {
          trigger: content,
          start: 'top 80%'
        }
      });
    });

    // Quote Animation
    gsap.set('.quote', { opacity: 0, y: 30 });
    gsap.to('.quote', {
      opacity: 1,
      y: 0,
      duration: 1.2,
      scrollTrigger: {
        trigger: '.quote-section',
        start: 'top 60%'
      }
    });

    // Transition Line Animations
    gsap.utils.toArray('.transition-line').forEach(line => {
      gsap.to(line, {
        height: 150,
        duration: 1,
        ease: 'power2.inOut',
        scrollTrigger: {
          trigger: line.closest('.transition-section'),
          start: 'top 70%'
        }
      });
    });

    // Finale Animations
    gsap.set('.finale-rings, .finale-title, .finale-text', { opacity: 0, y: 40 });

    gsap.to('.finale-rings', {
      opacity: 1,
      scale: 1,
      y: 0,
      duration: 1,
      scrollTrigger: {
        trigger: '.finale',
        start: 'top 60%'
      }
    });

    gsap.to('.finale-title', {
      opacity: 1,
      y: 0,
      duration: 1,
      delay: 0.3,
      scrollTrigger: {
        trigger: '.finale',
        start: 'top 60%'
      }
    });

    gsap.to('.finale-text', {
      opacity: 0.8,
      y: 0,
      duration: 1,
      delay: 0.5,
      scrollTrigger: {
        trigger: '.finale',
        start: 'top 60%'
      }
    });

    // Spinning rings in finale
    gsap.to('.ring:nth-child(1)', {
      rotation: 360,
      duration: 15,
      repeat: -1,
      ease: 'none'
    });

    gsap.to('.ring:nth-child(2)', {
      rotation: -360,
      duration: 20,
      repeat: -1,
      ease: 'none'
    });

    gsap.to('.ring:nth-child(3)', {
      rotation: 360,
      duration: 25,
      repeat: -1,
      ease: 'none'
    });

    // Progress Bar
    gsap.to('.progress-bar', {
      scaleX: 1,
      ease: 'none',
      scrollTrigger: {
        trigger: 'body',
        start: 'top top',
        end: 'bottom bottom',
        scrub: 0.3
      }
    });

    // Parallax effects on illustrations
    gsap.utils.toArray('.illustration svg').forEach(svg => {
      gsap.to(svg, {
        y: -50,
        scrollTrigger: {
          trigger: svg.closest('.chapter'),
          start: 'top center',
          end: 'bottom center',
          scrub: 1
        }
      });
    });

    // Endings explorer (interactive, no reload)
    const endingDetail = document.querySelector('[data-testid="pirates-ending-detail"]');
    const endingButtons = document.querySelectorAll('.ending-button[data-ending]');
    const ENDINGS = {
      unite: "A coalition of outlaws holds the fjords together by shared rules and shared spoils. The jarls lose not to conquest, but to unity.",
      betray: "You win by turning jarl against jarl and selling their oaths back to them. The fjords quiet down, but the quiet is bought with fear.",
      law: "Soren and Astrid bind pirates and Vikings to a code of passage. The North does not become good. It becomes possible.",
      break: "You shatter the runestones at the altar and disappear into pine and frost. No one owns the wind again, and the fjords must learn honesty."
    };

    function setEnding(id) {
      if (!endingDetail) return;
      endingButtons.forEach((btn) => {
        const isActive = btn.dataset.ending === id;
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-pressed', isActive ? 'true' : 'false');
      });
      endingDetail.textContent = ENDINGS[id] || "";
    }

    endingButtons.forEach((btn) => {
      btn.addEventListener('click', () => setEnding(btn.dataset.ending));
    });

    // Ensure initial state matches any pre-marked active button.
    const initial = document.querySelector('.ending-button.active')?.dataset.ending || 'unite';
    setEnding(initial);
  </script>
</body>
</html>
